exports.id=627,exports.ids=[627],exports.modules={3317:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},6779:()=>{},6816:(e,a,t)=>{"use strict";t.d(a,{Tm:()=>m,B6:()=>c,yM:()=>g,YM:()=>h,a$:()=>f,fj:()=>N});var l=t(326),r=t(7577),s=t(1223);function n({isOpen:e,onClose:a,title:t,deals:s}){let n=(0,r.useRef)(null),d=(0,r.useRef)(null),[i,o]=(0,r.useState)(""),c=(0,r.useMemo)(()=>{if(!i.trim())return s;let e=i.toLowerCase();return s.filter(a=>a.id.toString().includes(e)||a.title?.toLowerCase().includes(e)||a.pipeline?.toLowerCase().includes(e)||a.stage?.toLowerCase().includes(e)||a.nome_noivo?.toLowerCase().includes(e))},[s,i]);return e?l.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:e=>e.target===e.currentTarget&&a(),children:(0,l.jsxs)("div",{ref:n,className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] flex flex-col",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,l.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:[t," (",c.length,i?` de ${s.length}`:"",")"]}),l.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"\xd7"})]}),l.jsx("div",{className:"px-4 pt-4",children:l.jsx("input",{ref:d,type:"text",placeholder:"Buscar por ID, t\xedtulo, pipeline, stage ou nome...",value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})}),l.jsx("div",{className:"overflow-auto flex-1 p-4",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-100 sticky top-0",children:(0,l.jsxs)("tr",{children:[l.jsx("th",{className:"text-left p-2",children:"ID"}),l.jsx("th",{className:"text-left p-2",children:"T\xedtulo"}),l.jsx("th",{className:"text-left p-2",children:"Pipeline"}),l.jsx("th",{className:"text-left p-2",children:"Stage"}),l.jsx("th",{className:"text-left p-2",children:"Status"}),l.jsx("th",{className:"text-left p-2",children:"Criado"})]})}),(0,l.jsxs)("tbody",{children:[c.map(e=>(0,l.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[l.jsx("td",{className:"p-2",children:e.id}),l.jsx("td",{className:"p-2",children:e.title||"-"}),l.jsx("td",{className:"p-2",children:e.pipeline||"-"}),l.jsx("td",{className:"p-2",children:e.stage||"-"}),l.jsx("td",{className:"p-2",children:l.jsx("span",{className:`px-2 py-1 rounded text-xs ${"Won"===e.status?"bg-green-100 text-green-800":"Lost"===e.status?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:e.status||"Open"})}),l.jsx("td",{className:"p-2",children:e.created_at?new Date(e.created_at).toLocaleDateString("pt-BR"):"-"})]},e.id)),0===c.length&&l.jsx("tr",{children:l.jsx("td",{colSpan:6,className:"text-center p-8 text-gray-500",children:i?"Nenhum resultado encontrado":"Nenhum deal encontrado"})})]})]})})]})}):null}let d=["Leads","MQL","Agendamento","Reuni\xf5es","Qualificado","Closer Agendada","Closer realizada","Vendas","CPL","CVR (MQL)","CVR (Ag)","CVR (Reu)","CVR (SQL)","CVR (RA)","CVR (RR)","CVR (Venda)","Convers\xe3o","M\xe9dia Score"],i=["SDR Weddings","Closer Weddings","Planejamento Weddings"];function o(e,a,t){if(!e)return!1;let l=new Date(e);return l.getFullYear()===a&&l.getMonth()+1===t}function c({metrics:e,target:a,previousMetrics:t,monthProgress:c,cpl:u,deals:m=[],year:h=new Date().getFullYear(),month:g=new Date().getMonth()+1}){let[x,p]=(0,r.useState)(!1),[f,b]=(0,r.useState)(""),[v,j]=(0,r.useState)([]),N=(0,s.d)(e);t&&(0,s.d)(t);let y=e=>{switch(e){case"leads":return m;case"mql":return m.filter(e=>e.pipeline&&i.includes(e.pipeline));case"agendamento":return m.filter(e=>o(e.data_reuniao_1,h,g));case"reunioes":return m.filter(e=>o(e.data_reuniao_1,h,g)&&null!==e.como_reuniao_1&&""!==e.como_reuniao_1&&"N\xe3o teve reuni\xe3o"!==e.como_reuniao_1);case"qualificado":return m.filter(e=>o(e.data_qualificado,h,g)||!0===e.qualificado_sql);case"closerAgendada":return m.filter(e=>o(e.data_closer,h,g)||null!==e.data_closer&&""!==e.data_closer);case"closerRealizada":return m.filter(e=>null!==e.reuniao_closer&&""!==e.reuniao_closer);case"vendas":return m.filter(e=>o(e.data_fechamento,h,g)&&!e.title?.startsWith("EW"));default:return[]}},w=(e,a)=>{m.length&&(b(a),j(y(e)),p(!0))},_=a||{month:"",pipeline_type:"wedding",leads:0,mql:0,agendamento:0,reunioes:0,qualificado:0,closer_agendada:0,closer_realizada:0,vendas:0,cpl:0},R=[_.leads,_.mql,_.agendamento,_.reunioes,_.qualificado,_.closer_agendada,_.closer_realizada,_.vendas,(0,s.xG)(_.cpl),"70,00%","45,00%","70,00%","65,00%","100,00%","87,00%","35,00%","4,00%",""],q=[{stage:"leads",label:"Leads",value:e.leads},{stage:"mql",label:"MQL",value:e.mql},{stage:"agendamento",label:"Agendamento",value:e.agendamento},{stage:"reunioes",label:"Reuni\xf5es",value:e.reunioes},{stage:"qualificado",label:"Qualificado",value:e.qualificado},{stage:"closerAgendada",label:"Closer Agendada",value:e.closerAgendada},{stage:"closerRealizada",label:"Closer Realizada",value:e.closerRealizada},{stage:"vendas",label:"Vendas",value:e.vendas}],T=[e.leads,e.mql,e.agendamento,e.reunioes,e.qualificado,e.closerAgendada,e.closerRealizada,e.vendas,(0,s.xG)(u),(0,s.T3)(N.cvrMql),(0,s.T3)(N.cvrAg),(0,s.T3)(N.cvrReu),(0,s.T3)(N.cvrSql),(0,s.T3)(N.cvrRa),(0,s.T3)(N.cvrRr),(0,s.T3)(N.cvrVenda),(0,s.T3)(N.conversaoTotal),""],C=[(0,s.T3)((0,s.up)(e.leads,_.leads)),(0,s.T3)((0,s.up)(e.mql,_.mql)),(0,s.T3)((0,s.up)(e.agendamento,_.agendamento)),(0,s.T3)((0,s.up)(e.reunioes,_.reunioes)),(0,s.T3)((0,s.up)(e.qualificado,_.qualificado)),(0,s.T3)((0,s.up)(e.closerAgendada,_.closer_agendada)),(0,s.T3)((0,s.up)(e.closerRealizada,_.closer_realizada)),(0,s.T3)((0,s.up)(e.vendas,_.vendas)),"","","","","","","","","",""],S=[(0,s.Um)(_.leads,c),(0,s.Um)(_.mql,c),(0,s.Um)(_.agendamento,c),(0,s.Um)(_.reunioes,c),(0,s.Um)(_.qualificado,c),(0,s.Um)(_.closer_agendada,c),(0,s.Um)(_.closer_realizada,c),(0,s.Um)(_.vendas,c),"","","","","","","","","",""],A=t?[(0,s.T3)((0,s.up)(e.leads,t.leads)-100),(0,s.T3)((0,s.up)(e.mql,t.mql)-100),(0,s.T3)((0,s.up)(e.agendamento,t.agendamento)-100),(0,s.T3)((0,s.up)(e.reunioes,t.reunioes)-100),(0,s.T3)((0,s.up)(e.qualificado,t.qualificado)-100),(0,s.T3)((0,s.up)(e.closerAgendada,t.closerAgendada)-100),(0,s.T3)((0,s.up)(e.closerRealizada,t.closerRealizada)-100),"","","","","","","","","","",""]:Array(18).fill(""),D=t?[t.leads,t.mql,t.agendamento,t.reunioes,t.qualificado,t.closerAgendada,t.closerRealizada,t.vendas,"","","","","","","","","",""]:Array(18).fill(""),z=[(0,s.xG)(u*e.leads),(0,s.xG)(1.5*u*e.mql),(0,s.xG)(2*u*e.agendamento),(0,s.xG)(2.5*u*e.reunioes),(0,s.xG)(3*u*e.qualificado),(0,s.xG)(3.5*u*e.closerAgendada),(0,s.xG)(4*u*e.closerRealizada),"","","","","","","","","","",""];return(0,l.jsxs)(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"funnel-table",children:[l.jsx("thead",{children:(0,l.jsxs)("tr",{children:[l.jsx("th",{className:"w-32"}),d.map((e,a)=>l.jsx("th",{children:e},a))]})}),l.jsx("tbody",{children:[{label:"Planejado",data:R,className:"row-planejado"},{label:"Realizado",data:T,className:"row-realizado"},{label:"Atingimento (%)",data:C,className:"row-atingimento"},{label:"Deveria",data:S,className:"row-deveria"},{label:"Per\xedodo anterior (%)",data:A,className:"row-periodo-anterior-pct"},{label:"Per\xedodo Anterior",data:D,className:"row-periodo-anterior"},{label:"Custos",data:z,className:"row-custos"}].map((e,a)=>(0,l.jsxs)("tr",{className:e.className,children:[l.jsx("td",{className:"font-semibold text-left bg-gray-100",children:e.label}),e.data.map((a,t)=>{let r="Realizado"===e.label&&t<8&&m.length>0;return l.jsx("td",{className:`${"string"==typeof a&&a.startsWith("-")?"negative":""} ${r?"cursor-pointer hover:bg-primary/10 hover:text-primary transition-colors":""}`,onClick:r?()=>w(q[t].stage,q[t].label):void 0,children:r?l.jsx("span",{className:"underline decoration-dotted",children:a}):a},t)})]},a))})]})}),l.jsx(n,{isOpen:x,onClose:()=>p(!1),title:f,deals:v})]})}let u=["Leads","Vendas","CVR (Leads → Vendas)","M\xe9dia Score"];function m({metrics:e,target:a,previousMetrics:t,deals:d=[],year:i=new Date().getFullYear(),month:o=new Date().getMonth()+1}){let[c,m]=(0,r.useState)(!1),[h,g]=(0,r.useState)(""),[x,p]=(0,r.useState)([]),f=(0,s.d5)(e.leads,e.vendas),b=e=>{switch(e){case"leads":return d;case"vendas":return d.filter(e=>(function(e,a,t){if(!e)return!1;let l=new Date(e);return l.getFullYear()===a&&l.getMonth()+1===t})(e.data_fechamento,i,o));default:return[]}},v=(e,a)=>{d.length&&(g(a),p(b(e)),m(!0))},j=[{stage:"leads",label:"Leads"},{stage:"vendas",label:"Vendas"}],N=a||{leads:0,vendas:0},y=[{label:"Planejado",data:[N.leads,N.vendas,"—","—"],className:"row-planejado"},{label:"Realizado",data:[e.leads,e.vendas,(0,s.T3)(f),"50"],className:"row-realizado"},{label:"Atingimento (%)",data:[(0,s.T3)((0,s.up)(e.leads,N.leads)),(0,s.T3)((0,s.up)(e.vendas,N.vendas)),"—","—"],className:"row-atingimento"},{label:"Per\xedodo Anterior",data:t?[t.leads,t.vendas,(0,s.T3)((0,s.d5)(t.leads,t.vendas)),"—"]:["—","—","—","—"],className:"row-periodo-anterior"}];return(0,l.jsxs)(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"funnel-table",children:[l.jsx("thead",{children:(0,l.jsxs)("tr",{children:[l.jsx("th",{className:"w-32"}),u.map((e,a)=>l.jsx("th",{children:e},a))]})}),l.jsx("tbody",{children:y.map((e,a)=>(0,l.jsxs)("tr",{className:e.className,children:[l.jsx("td",{className:"font-semibold text-left bg-gray-100",children:e.label}),e.data.map((a,t)=>{let r="Realizado"===e.label&&t<2&&d.length>0;return l.jsx("td",{className:r?"cursor-pointer hover:bg-primary/10 hover:text-primary transition-colors":"",onClick:r?()=>v(j[t].stage,j[t].label):void 0,children:r?l.jsx("span",{className:"underline decoration-dotted",children:a}):a},t)})]},a))})]})}),l.jsx(n,{isOpen:c,onClose:()=>m(!1),title:h,deals:x})]})}function h({monthProgress:e,resultProgress:a,investment:t}){return(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-primary",children:[l.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Percorrido M\xeas"}),l.jsx("div",{className:"text-2xl font-bold text-primary",children:(0,s.T3)(e)})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-primary",children:[l.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Resultado At\xe9 o Momento"}),l.jsx("div",{className:"text-2xl font-bold text-primary",children:(0,s.T3)(a)})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-primary",children:[l.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Investimento At\xe9 o Momento"}),l.jsx("div",{className:"text-2xl font-bold text-primary",children:(0,s.xG)(t)})]})]})}function g({selectedMonth:e,lastUpdate:a}){let t=e.toLocaleDateString("pt-BR",{month:"long"}).toUpperCase(),r=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),s=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0);return(0,l.jsxs)("div",{className:"bg-primary text-white rounded-t-lg",children:[l.jsx("div",{className:"text-center py-2 text-2xl font-bold border-b border-primary-dark",children:t}),(0,l.jsxs)("div",{className:"grid grid-cols-6 text-sm",children:[(0,l.jsxs)("div",{className:"border-r border-primary-dark p-2",children:[l.jsx("div",{className:"text-primary-light text-xs",children:"Dias do M\xeas"}),l.jsx("div",{className:"font-semibold",children:r})]}),(0,l.jsxs)("div",{className:"border-r border-primary-dark p-2",children:[l.jsx("div",{className:"text-primary-light text-xs",children:"Data de Hoje"}),l.jsx("div",{className:"font-semibold",children:x(new Date)})]}),(0,l.jsxs)("div",{className:"border-r border-primary-dark p-2",children:[l.jsx("div",{className:"text-primary-light text-xs",children:"Data in\xedcio"}),l.jsx("div",{className:"font-semibold",children:x(s)})]}),(0,l.jsxs)("div",{className:"border-r border-primary-dark p-2",children:[l.jsx("div",{className:"text-primary-light text-xs",children:"Data fim"}),l.jsx("div",{className:"font-semibold",children:x(n)})]}),(0,l.jsxs)("div",{className:"border-r border-primary-dark p-2",children:[l.jsx("div",{className:"text-primary-light text-xs",children:"Data Atualiza\xe7\xe3o"}),l.jsx("div",{className:"font-semibold",children:x(a)})]}),(0,l.jsxs)("div",{className:"p-2",children:[l.jsx("div",{className:"text-primary-light text-xs",children:"\xa0"}),l.jsx("div",{children:"\xa0"})]})]})]})}function x(e){let a=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0"),l=e.getFullYear();return`${a}/${t}/${l}`}let p=["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];function f({selectedYear:e,selectedMonth:a,onChange:t}){let r=new Date().getFullYear(),s=Array.from({length:5},(e,a)=>r-2+a);return(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[l.jsx("select",{value:a,onChange:a=>t(e,Number(a.target.value)),className:"border border-gray-300 rounded px-3 py-2 bg-white",children:p.map((e,a)=>l.jsx("option",{value:a+1,children:e},a))}),l.jsx("select",{value:e,onChange:e=>t(Number(e.target.value),a),className:"border border-gray-300 rounded px-3 py-2 bg-white",children:s.map(e=>l.jsx("option",{value:e,children:e},e))})]})}var b=t(434),v=t(5047);let j=[{href:"/total",label:"Total"},{href:"/wedding",label:"WW General"},{href:"/elopement",label:"Elopement"}];function N({year:e,month:a}){let t=(0,v.usePathname)(),r=t=>e&&a?`${t}?year=${e}&month=${a}`:t;return l.jsx("div",{className:"flex rounded-lg overflow-hidden border border-primary",children:j.map(e=>l.jsx(b.default,{href:r(e.href),className:`px-4 py-2 font-medium transition-colors ${t===e.href?"bg-primary text-white":"bg-white text-primary hover:bg-primary-light hover:text-white"}`,children:e.label},e.href))})}},8873:(e,a,t)=>{"use strict";t.d(a,{P2:()=>u,yg:()=>i,OU:()=>m,xw:()=>h});var l=t(3815);let r="https://ypzpkdgdbzruagjixwyc.supabase.co",s="sb_publishable_qTJmNRw6ugSBXzNMOU79hg_yrECc3f4",n=r&&s?(0,l.eI)(r,s):null;var d=t(1223);async function i(e,a,t){let{start:l,end:r}=(0,d.FK)(e,a),s=n.from("deals").select("*").gte("created_at",l.toISOString()).lte("created_at",r.toISOString());s="elopement"===t?s.eq("is_elopement",!0):s.eq("is_elopement",!1);let{data:i,error:o}=await s;return o?(console.error("Error fetching deals:",o),[]):i}let o=["SDR Weddings","Closer Weddings","Planejamento Weddings"];function c(e,a,t){if(!e)return!1;let l=new Date(e);return l.getFullYear()===a&&l.getMonth()+1===t}function u(e,a,t){return{leads:e.length,mql:e.filter(e=>e.pipeline&&o.includes(e.pipeline)).length,agendamento:e.filter(e=>c(e.data_reuniao_1,a,t)).length,reunioes:e.filter(e=>c(e.data_reuniao_1,a,t)&&null!==e.como_reuniao_1&&""!==e.como_reuniao_1&&"N\xe3o teve reuni\xe3o"!==e.como_reuniao_1).length,qualificado:e.filter(e=>c(e.data_qualificado,a,t)||!0===e.qualificado_sql).length,closerAgendada:e.filter(e=>c(e.data_closer,a,t)||null!==e.data_closer&&""!==e.data_closer).length,closerRealizada:e.filter(e=>null!==e.reuniao_closer&&""!==e.reuniao_closer).length,vendas:e.filter(e=>c(e.data_fechamento,a,t)&&!e.title?.startsWith("EW")).length}}async function m(e,a,t){let l=`${e}-${String(a).padStart(2,"0")}-01`,{data:r,error:s}=await n.from("monthly_targets").select("*").eq("month",l).eq("pipeline_type","elopement"===t?"elopement":"wedding").maybeSingle();return s?(console.error("Error fetching target:",s),null):r}async function h(e,a,t){let l=e,r=a-1;return 0===r&&(r=12,l=e-1),u(await i(l,r,t),l,r)}},1223:(e,a,t)=>{"use strict";t.d(a,{FK:()=>h,T3:()=>d,Um:()=>u,d:()=>m,d5:()=>o,up:()=>c,xG:()=>n,xc:()=>i});var l=t(641),r=t(9559),s=t(3704);function n(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function d(e){return`${e.toFixed(2)}%`}function i(e=new Date){let a=(0,l.N)(e);return e.getDate()/a*100}function o(e,a){return 0===e?0:a/e*100}function c(e,a){return 0===a?0:e/a*100}function u(e,a){return Math.round(a/100*e)}function m(e){return{cvrMql:o(e.leads,e.mql),cvrAg:o(e.mql,e.agendamento),cvrReu:o(e.agendamento,e.reunioes),cvrSql:o(e.reunioes,e.qualificado),cvrRa:o(e.qualificado,e.closerAgendada),cvrRr:o(e.closerAgendada,e.closerRealizada),cvrVenda:o(e.closerRealizada,e.vendas),conversaoTotal:o(e.leads,e.vendas)}}function h(e,a){let t=new Date(e,a-1,1);return{start:(0,r.N)(t),end:(0,s.V)(t)}}},2029:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>d,metadata:()=>n});var l=t(9510),r=t(5317),s=t.n(r);t(5023);let n={title:"Welcome Dashboard",description:"Sales funnel dashboard for Welcome Weddings"};function d({children:e}){return l.jsx("html",{lang:"pt-BR",children:l.jsx("body",{className:s().className,children:e})})}},5023:()=>{}};